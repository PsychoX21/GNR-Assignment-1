# MNIST (data_1) - High Accuracy Config
# Adapted for 28x28x1 Input
# Uses strided convolutions for downsampling

# Spatial size flow (28x28 input):
#   Block 1: 28 -> 26 -> 24 -> 12
#   Block 2: 12 -> 10 ->  8 ->  4
#   Block 3:  4 ->  1
#   Flatten: 128 * 1 * 1 = 128

model:
  name: "MNIST_HighAcc_28x28"
  architecture:
    # Block 1: 1 -> 32, spatial 28 -> 12
    - type: "Conv2D"
      in_channels: 1
      out_channels: 32
      kernel_size: 3
      stride: 1
      padding: 0
    
    - type: "BatchNorm2D"
      num_features: 32
    
    - type: "ReLU"
    
    - type: "Conv2D"
      in_channels: 32
      out_channels: 32
      kernel_size: 3
      stride: 1
      padding: 0
    
    - type: "BatchNorm2D"
      num_features: 32
    
    - type: "ReLU"
    
    - type: "Conv2D"
      in_channels: 32
      out_channels: 32
      kernel_size: 5
      stride: 2
      padding: 2
    
    - type: "BatchNorm2D"
      num_features: 32
    
    - type: "ReLU"
    
    - type: "Dropout"
      p: 0.4
    
    # Block 2: 32 -> 64, spatial 12 -> 4
    - type: "Conv2D"
      in_channels: 32
      out_channels: 64
      kernel_size: 3
      stride: 1
      padding: 0
    
    - type: "BatchNorm2D"
      num_features: 64
    
    - type: "ReLU"
    
    - type: "Conv2D"
      in_channels: 64
      out_channels: 64
      kernel_size: 3
      stride: 1
      padding: 0
    
    - type: "BatchNorm2D"
      num_features: 64
    
    - type: "ReLU"
    
    - type: "Conv2D"
      in_channels: 64
      out_channels: 64
      kernel_size: 5
      stride: 2
      padding: 2
    
    - type: "BatchNorm2D"
      num_features: 64
    
    - type: "ReLU"
    
    - type: "Dropout"
      p: 0.4
    
    # Block 3: 64 -> 128, spatial 4 -> 1
    - type: "Conv2D"
      in_channels: 64
      out_channels: 128
      kernel_size: 4
      stride: 1
      padding: 0
    
    - type: "BatchNorm2D"
      num_features: 128
    
    - type: "ReLU"
    
    # Classifier: 128 * 1 * 1 = 128
    - type: "Flatten"
    
    - type: "Dropout"
      p: 0.4
    
    - type: "Linear"
      in_features: 128
      out_features: "num_classes"

training:
  epochs: 50
  batch_size: 128
  learning_rate: 0.001
  optimizer: "Adam"
  weight_decay: 0.0
  
  scheduler:
    type: "StepLR"
    step_size: 1
    gamma: 0.95

data:
  image_size: 28
  channels: 1
  augmentation:
    enabled: false

device:
  use_cuda: true
  device_id: 0