# Optimized CNN Configuration for 32x32 Images
# Much faster than original - designed for quick training

model:
  name: "FastCNN"
  architecture:
    # Block 1: 3 -> 32
    - type: "Conv2D"
      in_channels: 3
      out_channels: 32
      kernel_size: 3
      stride: 1
      padding: 1
    
    - type: "BatchNorm2D"
      num_features: 32
    
    - type: "ReLU"
    
    - type: "MaxPool2D"
      kernel_size: 2
      stride: 2
    # Now 16x16
    
    - type: "Dropout"
      p: 0.25
    
    # Block 2: 32 -> 64
    - type: "Conv2D"
      in_channels: 32
      out_channels: 64
      kernel_size: 3
      stride: 1
      padding: 1
    
    - type: "BatchNorm2D"
      num_features: 64
    
    - type: "ReLU"
    
    - type: "MaxPool2D"
      kernel_size: 2
      stride: 2
    # Now 8x8
    
    - type: "Dropout"
      p: 0.25
    
    # Block 3: 64 -> 128
    - type: "Conv2D"
      in_channels: 64
      out_channels: 128
      kernel_size: 3
      stride: 1
      padding: 1
    
    - type: "BatchNorm2D"
      num_features: 128
    
    - type: "ReLU"
    
    - type: "MaxPool2D"
      kernel_size: 2
      stride: 2
    # Now 4x4
    
    - type: "Dropout"
      p: 0.5
    
    # Classifier
    - type: "Flatten"
    
    - type: "Linear"
      in_features: 2048  # 128 * 4 * 4
      out_features: 256
    
    - type: "BatchNorm1D"
      num_features: 256
    
    - type: "ReLU"
    
    - type: "Dropout"
      p: 0.5
    
    - type: "Linear"
      in_features: 256
      out_features: 10  # num_classes (will be auto-detected)

training:
  epochs: 50
  batch_size: 128  # Increased for faster training
  learning_rate: 0.001
  optimizer: "Adam"
  betas: [0.9, 0.999]
  weight_decay: 0.0001
  
  scheduler:
    type: "StepLR"
    step_size: 20
    gamma: 0.1
  
  early_stopping:
    enabled: true
    patience: 10
    min_delta: 0.001

data:
  image_size: 32
  augmentation:
    enabled: true
    horizontal_flip: 0.5
    rotation: 10
    brightness: 0.1
    contrast: 0.1

device:
  use_cuda: true
  device_id: 0
