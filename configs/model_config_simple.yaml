# Minimal LeNet-style CNN for MNIST (32x32)
# Designed for FAST training with C++ backend (naive convolutions)
# Target: 98%+ accuracy in reasonable time

model:
  name: "SimpleLeNet"
  architecture:
    # Conv Block 1: 3 -> 16 channels
    - type: "Conv2D"
      in_channels: 3
      out_channels: 16
      kernel_size: 3
      stride: 1
      padding: 1
    
    - type: "ReLU"
    
    - type: "MaxPool2D"
      kernel_size: 2
      stride: 2
    # Now 16x16
    
    # Conv Block 2: 16 -> 32 channels
    - type: "Conv2D"
      in_channels: 16
      out_channels: 32
      kernel_size: 3
      stride: 1
      padding: 1
    
    - type: "ReLU"
    
    - type: "MaxPool2D"
      kernel_size: 2
      stride: 2
    # Now 8x8
    
    # Classifier
    - type: "Flatten"
    
    - type: "Linear"
      in_features: 2048  # 32 * 8 * 8
      out_features: 128
    
    - type: "ReLU"
    
    - type: "Dropout"
      p: 0.5
    
    - type: "Linear"
      in_features: 128
      out_features: 10

training:
  epochs: 30
  batch_size: 64
  learning_rate: 0.01
  optimizer: "SGD"
  momentum: 0.9
  weight_decay: 0.0001
  
  scheduler:
    type: "StepLR"
    step_size: 10
    gamma: 0.5

data:
  image_size: 32
  augmentation:
    enabled: false  # Disable for speed

device:
  use_cuda: true
  device_id: 0
